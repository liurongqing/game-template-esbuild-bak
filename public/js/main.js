(()=>{var zo=Object.defineProperty;var Vo=(e,t)=>{for(var r in t)zo(e,r,{get:t[r],enumerable:!0})};function et(e){let t;return e&&(typeof e=="string"?t=document.getElementById(e):typeof e=="object"&&e.nodeType===1&&(t=e)),t||(t=document.body),t}function ae(e,t){return et(t).appendChild(e),e}function fe(e){let t=document.readyState;if(t==="complete"||t==="interactive"){e();return}let r=()=>{document.removeEventListener("deviceready",r,!0),document.removeEventListener("DOMContentLoaded",r,!0),window.removeEventListener("load",r,!0),e()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",r,!0):(document.addEventListener("DOMContentLoaded",r,!0),window.addEventListener("load",r,!0)):window.setTimeout(r,20)}function S(e,t,...r){if(e.events.size===0||!e.events.has(t))return!1;let o=e.events.get(t);for(let n of o)n.callback.apply(n.context,r),n.once&&o.delete(n);return o.size===0&&e.events.delete(t),!0}var W=class{constructor(){this.events=new Map}};var Y=class{constructor(t,r,o=!1){this.callback=t,this.context=r,this.once=o}};function I(e,t,r,o,n){let s=e.events,a=s.get(t);if(!r)s.delete(t);else if(r instanceof Y)a.delete(r);else{let f=!o,u=n!==void 0;for(let h of a)h.callback===r&&f&&h.context===o&&u&&h.once===n&&a.delete(h)}return a.size===0&&s.delete(t),e}function w(e,t,r,o=e,n=!1){if(typeof r!="function")throw new TypeError("Listener not a function");let s=new Y(r,o,n),a=e.events.get(t);return a?a.add(s):e.events.set(t,new Set([s])),s}function rt(e,t,r,o=e){return w(e,t,r,o,!0)}var Hr,qr=0,jr=0,R={get:()=>Hr,set:e=>{Hr=e},getFrame:()=>qr,setFrame:e=>{qr=e},getElapsed:()=>jr,setElapsed:e=>{jr=e}};var m={AUTO:"Auto",BACKGROUND_COLOR:"BackgroundColor",BANNER:"Banner",BATCH_SIZE:"BatchSize",CANVAS_CONTEXT:"CanvasContext",CANVAS:"Canvas",DEFAULT_ORIGIN:"DefaultOrigin",GLOBAL_VAR:"GlobalVar",MAX_TEXTURES:"MaxTextures",PARENT:"Parent",RENDERER:"Renderer",SCENES:"Scenes",SIZE:"Size",WEBGL_CONTEXT:"WebGLContext",WEBGL:"WebGL"};var c=new Map;function wt(e="",t="",r="",o="#fff",n="linear-gradient(#3e0081 40%, #00bcc3)"){c.set(m.BANNER,{title:e,version:t,url:r,color:o,background:n})}function ue(){let{title:e,version:t,url:r,color:o,background:n}=c.get(m.BANNER);if(e!==""){let s=t!==""?e+" "+t:e;console.log(`%c${s}%c ${r}`,`padding: 4px 16px; color: ${o}; background: ${n}`,"")}}function me(){return c.get(m.GLOBAL_VAR)}function ce(){return c.get(m.PARENT)}function he(e){e&&c.set(m.PARENT,et(e))}function Ft(e){return()=>{he(e)}}function le(){return c.get(m.RENDERER)}function Dt(e){c.set(m.RENDERER,e)}function $r(){return{gameFrame:0,numTotalFrames:0,numDirtyFrames:0,numDirtyCameras:0,worldData:[]}}function pe(){return c.get(m.SCENES)}function de(e){c.set(m.SCENES,[].concat(e))}function Bt(e){return()=>{de(e)}}function Zr(e,t=0){e.gameFrame=t,e.numTotalFrames=0,e.numDirtyFrames=0,e.numDirtyCameras=0,e.worldData.length=0}var Kr,Gt={get:()=>Kr,set:e=>{Kr=e}};var xe=class{constructor(){this.scenes=new Map,this.sceneIndex=0,this.flush=!1,this.renderResult=$r(),this.game=R.get(),Gt.set(this),rt(this.game,"boot",()=>this.boot())}boot(){pe().forEach(t=>new t)}update(t,r){for(let o of this.scenes.values())S(o,"update",t,r)}render(t){let r=this.renderResult;Zr(r,t);for(let o of this.scenes.values())S(o,"render",r);return this.flush&&(r.numDirtyFrames++,this.flush=!1),r}};function It(e){c.set(m.BACKGROUND_COLOR,e)}function Se(e){c.set(m.BATCH_SIZE,e)}function Ot(e=.5,t=e){c.set(m.DEFAULT_ORIGIN,{x:e,y:t})}function X(e){c.set(m.MAX_TEXTURES,e)}function ot(e=800,t=600,r=1){r===0&&(r=window.devicePixelRatio),c.set(m.SIZE,{width:e,height:t,resolution:r})}function ge(){return c.get(m.WEBGL_CONTEXT)}function _t(e){c.set(m.WEBGL_CONTEXT,e)}function Jr(){It(0),Se(4096),wt("Phaser","4.0.0","https://phaser4.io"),X(0),Ot(.5,.5),ot(800,600,1),_t({antialias:!0,desynchronized:!0,preserveDrawingBuffer:!0})}function it(e,t){let r=document.createElement("canvas");return r.width=e,r.height=t,r.getContext("2d")}var Te=[],Q={add:(e,t)=>{Te.push({texture:e,glConfig:t})},get:()=>Te,clear:()=>{Te.length=0}};var H=class{constructor(t,r,o,n,s,a){this.trimmed=!1,this.texture=t,this.key=r,this.x=o,this.y=n,this.width=s,this.height=a,this.sourceSizeWidth=s,this.sourceSizeHeight=a,this.updateUVs()}setPivot(t,r){this.pivot={x:t,y:r}}setSize(t,r){this.width=t,this.height=r,this.sourceSizeWidth=t,this.sourceSizeHeight=r,this.updateUVs()}setSourceSize(t,r){this.sourceSizeWidth=t,this.sourceSizeHeight=r}setTrim(t,r,o,n,s,a){this.trimmed=!0,this.sourceSizeWidth=t,this.sourceSizeHeight=r,this.spriteSourceSizeX=o,this.spriteSourceSizeY=n,this.spriteSourceSizeWidth=s,this.spriteSourceSizeHeight=a}getExtent(t,r){let o=this.sourceSizeWidth,n=this.sourceSizeHeight,s,a,f,u;return this.trimmed?(s=this.spriteSourceSizeX-t*o,a=s+this.spriteSourceSizeWidth,f=this.spriteSourceSizeY-r*n,u=f+this.spriteSourceSizeHeight):(s=-t*o,a=s+o,f=-r*n,u=f+n),{left:s,right:a,top:f,bottom:u}}copyToExtent(t){let r=t.originX,o=t.originY,n=this.sourceSizeWidth,s=this.sourceSizeHeight,a,f,u,h;return this.trimmed?(a=this.spriteSourceSizeX-r*n,f=this.spriteSourceSizeY-o*s,u=this.spriteSourceSizeWidth,h=this.spriteSourceSizeHeight):(a=-r*n,f=-o*s,u=n,h=s),t.setExtent(a,f,u,h),this}copyToVertices(t,r=0){let{u0:o,u1:n,v0:s,v1:a}=this;return t[r+0].setUV(o,s),t[r+1].setUV(o,a),t[r+2].setUV(n,a),t[r+3].setUV(n,s),this}updateUVs(){let{x:t,y:r,width:o,height:n}=this,s=this.texture.width,a=this.texture.height;this.u0=t/s,this.v0=r/a,this.u1=(t+o)/s,this.v1=(r+n)/a}destroy(){this.texture=null}};var M=class{constructor(t,r,o,n){this.key="",t&&(r=t.width,o=t.height),this.image=t,this.width=r,this.height=o,this.frames=new Map,this.data={},this.addFrame("__BASE",0,0,r,o),Q.add(this,n)}addFrame(t,r,o,n,s){if(this.frames.has(t))return null;let a=new H(this,t,r,o,n,s);return this.frames.set(t,a),(!this.firstFrame||this.firstFrame.key==="__BASE")&&(this.firstFrame=a),a}getFrame(t){if(!t)return this.firstFrame;t instanceof H&&(t=t.key);let r=this.frames.get(t);return r||(console.warn(`Frame missing: ${t}`),r=this.firstFrame),r}setSize(t,r){this.width=t,this.height=r,this.frames.get("__BASE").setSize(t,r)}destroy(){this.binding&&this.binding.destroy(),this.frames.clear(),this.data=null,this.image=null,this.firstFrame=null}};var to,D={get:()=>to,set:e=>{to=e}};var Ce=class{constructor(){this.textures=new Map,this.createDefaultTextures(),D.set(this)}createDefaultTextures(){this.add("__BLANK",new M(it(32,32).canvas));let t=it(32,32);t.strokeStyle="#0f0",t.moveTo(0,0),t.lineTo(32,32),t.stroke(),t.strokeRect(.5,.5,31,31),this.add("__MISSING",new M(t.canvas));let r=it(32,32);r.fillStyle="#fff",r.fillRect(0,0,32,32),this.add("__WHITE",new M(r.canvas))}get(t){let r=this.textures;return r.has(t)?r.get(t):r.get("__MISSING")}has(t){return this.textures.has(t)}add(t,r,o){let n,s=this.textures;return s.has(t)||(r instanceof M?n=r:n=new M(r,0,0,o),n.key=t,s.set(t,n)),n}};var Re=class extends W{constructor(...t){super();this.VERSION="4.0.0-beta1",this.isBooted=!1,this.isPaused=!1,this.willUpdate=!0,this.willRender=!0,this.lastTick=0,this.elapsed=0,this.frame=0,R.set(this),Jr(),fe(()=>this.boot(t))}boot(t){t.forEach(s=>s());let r=le();this.renderer=new r,this.textureManager=new Ce,this.sceneManager=new xe;let o=ce();o&&ae(this.renderer.canvas,o);let n=me();n&&window&&(window[n]=this),this.isBooted=!0,ue(),S(this,"boot"),this.lastTick=performance.now(),this.step(this.lastTick)}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.lastTick=performance.now()}step(t){let r=t-this.lastTick;this.lastTick=t,this.elapsed+=r,this.isPaused||(this.willUpdate&&(this.sceneManager.update(r,t),S(this,"update",r,t)),this.willRender&&this.renderer.render(this.sceneManager.render(this.frame))),this.frame++,R.setFrame(this.frame),R.setElapsed(this.elapsed),requestAnimationFrame(o=>this.step(o))}destroy(){}};function ye(e){return()=>{It(e)}}function O(){return c.get(m.SIZE).height}function _(){return c.get(m.SIZE).resolution}function L(){return c.get(m.SIZE).width}function Lt(e=800,t=600,r=1){return()=>{ot(e,t,r)}}function Me(){return c.get(m.BACKGROUND_COLOR)}function eo(e,t,r){return e.width<=0||e.height<=0?!1:e.x<=t&&e.x+e.width>=t&&e.y<=r&&e.y+e.height>=r}var E=class{constructor(t=0,r=0,o=0,n=0){this.set(t,r,o,n)}set(t=0,r=0,o=0,n=0){return this.x=t,this.y=r,this.width=o,this.height=n,this}contains(t,r){return eo(this,t,r)}set right(t){t<=this.x?this.width=0:this.width=t-this.x}get right(){return this.x+this.width}set bottom(t){t<=this.y?this.height=0:this.height=t-this.y}get bottom(){return this.y+this.height}};function Ee(e,t=0,r=0,o=0,n=0){let s=new E(t,r,o,n);return e.viewportStack.push(s),s}var i,ro={get:()=>i,set:e=>{i=e}};function v(e,t){if(!t&&(t=e.currentViewport,!t))return;let r=i.getParameter(i.VIEWPORT);(r[0]!==t.x||r[1]!==t.y||r[2]!==t.width||r[3]!==t.height)&&i.viewport(t.x,t.y,t.width,t.height)}function be(e,t=0,r=0,o=0,n=0){let s=Ee(e,t,r,o,n);v(e,s),e.currentViewport=s}function N(e,t=!0,r){r||(r=e.currentFramebuffer);let{framebuffer:o,viewport:n}=r;i.bindFramebuffer(i.FRAMEBUFFER,o),t&&(i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)),n&&be(e,n.x,n.y,n.width,n.height)}function Ae(e){let t=e.viewportStack;t.length>1&&t.pop(),e.currentViewport=t[t.length-1],v(e)}function nt(e){let t=e.framebufferStack;t.length>1&&(e.currentFramebuffer.viewport&&Ae(e),t.pop()),e.currentFramebuffer=t[t.length-1],N(e,!1)}function we(e,t,r){let o={framebuffer:t,viewport:r};return e.framebufferStack.push(o),o}function vt(e,t,r=!0,o){let n=we(e,t,o);N(e,r,n),e.currentFramebuffer=n}function Fe(e){let t=e.count;if(t===0)return;let r=e.currentVertexBuffer,o=e.currentShader,n=o.shader.renderToFramebuffer;if(n&&vt(e,o.shader.framebuffer,!0),t===r.batchSize){let s=r.isDynamic?i.DYNAMIC_DRAW:i.STATIC_DRAW;i.bufferData(i.ARRAY_BUFFER,r.data,s)}else{let s=r.indexed?t*r.entryElementSize:t*r.vertexElementSize,a=r.vertexViewF32.subarray(0,s);i.bufferSubData(i.ARRAY_BUFFER,0,a)}r.indexed?i.drawElements(i.TRIANGLES,t*r.entryIndexSize,i.UNSIGNED_SHORT,0):i.drawArrays(i.TRIANGLES,0,t),n&&nt(e)}function b(e,t){t&&(e.count=t);let r=e.count;return r===0?!1:(Fe(e),e.prevCount=r,e.count=0,e.flushTotal++,!0)}function De(e){b(e)}function oo(e,t=[]){let r=e>>16&255,o=e>>8&255,n=e&255,s=e>16777215?e>>>24:255;return t[0]=r/255,t[1]=o/255,t[2]=n/255,t[3]=s/255,t}function Nt(e){let{parent:t,flipY:r,unpackPremultiplyAlpha:o,minFilter:n,magFilter:s,wrapS:a,wrapT:f,generateMipmap:u,isPOT:h}=e,d=t.image,x=t.width,g=t.height,y=i.createTexture();return i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,y),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,r),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),d?(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,d),x=d.width,g=d.height):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,x,g,0,i.RGBA,i.UNSIGNED_BYTE,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,f),u&&h&&i.generateMipmap(i.TEXTURE_2D),e.texture=y,y}function st(e){i&&i.isFramebuffer(e)&&i.deleteFramebuffer(e)}function at(e){i.isTexture(e)&&i.deleteTexture(e)}function io(e,t){return e<1||t<1?!1:(e&e-1)==0&&(t&t-1)==0}function no(e,t=!0){i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e);let r=t?i.LINEAR:i.NEAREST;i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,r)}function so(e){let t=e.parent.image,r=t.width,o=t.height;return r>0&&o>0&&(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e.flipY),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)),e.texture}var q=class{constructor(t,r={}){this.index=0,this.indexCounter=-1,this.dirtyIndex=!0,this.unpackPremultiplyAlpha=!0,this.flipY=!1,this.isPOT=!1,this.generateMipmap=!1,this.parent=t,this.isPOT=io(t.width,t.height);let{texture:o=null,framebuffer:n=null,depthbuffer:s=null,unpackPremultiplyAlpha:a=!0,minFilter:f=this.isPOT?i.LINEAR_MIPMAP_LINEAR:i.LINEAR,magFilter:u=i.LINEAR,wrapS:h=i.CLAMP_TO_EDGE,wrapT:d=i.CLAMP_TO_EDGE,generateMipmap:x=this.isPOT,flipY:g=!1}=r;this.minFilter=f,this.magFilter=u,this.wrapS=h,this.wrapT=d,this.generateMipmap=x,this.flipY=g,this.unpackPremultiplyAlpha=a,n&&(this.framebuffer=n),s&&(this.depthbuffer=s),o?this.texture=o:Nt(this)}setFilter(t){this.texture&&no(this.texture,t)}create(){let t=this.texture;return t&&at(t),Nt(this)}update(){return this.texture?so(this):Nt(this)}setIndex(t){this.dirtyIndex=t!==this.index,this.index=t}destroy(){at(this.texture),st(this.framebuffer),this.parent=null,this.texture=null,this.framebuffer=null}};function Be(){Q.get().forEach(t=>{let{texture:r,glConfig:o}=t;r.binding||(r.binding=new q(r,o))}),Q.clear()}function ft(){return c.get(m.MAX_TEXTURES)}var Qo=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Ho(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Ge(e){let t=i.createShader(i.FRAGMENT_SHADER);for(;;){let r=Qo.replace(/%forloop%/gi,Ho(e));if(i.shaderSource(t,r),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS))e=e/2|0;else break}return e}function Ie(e){let t=Ge(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)),r=ft();r===0||r>0&&r>t?X(t):r>0&&r<t&&(t=Math.max(8,r));let o=e.tempTextures;o.length&&o.forEach(s=>{i.deleteTexture(s)});let n=[];for(let s=0;s<t;s++){let a=i.createTexture();i.activeTexture(i.TEXTURE0+s),i.bindTexture(i.TEXTURE_2D,a),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),o[s]=a,n.push(s)}e.maxTextures=t,e.textureIndex=n,e.currentActiveTexture=1}function ao(){return c.get(m.BATCH_SIZE)}function ut(e){i.isBuffer(e)&&i.deleteBuffer(e)}var Oe=class{constructor(t={}){this.indexed=!1,this.isDynamic=!1,this.count=0,this.offset=0;let{batchSize:r=1,dataSize:o=4,isDynamic:n=!0,elementsPerEntry:s=4,vertexElementSize:a=6}=t;this.batchSize=r,this.dataSize=o,this.vertexElementSize=a,this.isDynamic=n,this.elementsPerEntry=s,this.vertexByteSize=a*o,this.entryByteSize=this.vertexByteSize*s,this.bufferByteSize=r*this.entryByteSize,this.create()}resize(t){this.batchSize=t,this.bufferByteSize=t*this.entryByteSize,this.vertexBuffer&&ut(this.vertexBuffer),this.create()}create(){let t=new ArrayBuffer(this.bufferByteSize);this.data=t,this.vertexViewF32=new Float32Array(t),this.vertexViewU32=new Uint32Array(t),this.vertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer);let r=this.isDynamic?i.DYNAMIC_DRAW:i.STATIC_DRAW;i.bufferData(i.ARRAY_BUFFER,t,r),i.bindBuffer(i.ARRAY_BUFFER,null)}add(t){this.count+=t,this.offset+=this.vertexElementSize*t}reset(){this.count=0,this.offset=0}canContain(t){return this.count+t<=this.batchSize}free(){return Math.max(0,1-this.count/this.batchSize)}bind(){i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer)}destroy(){ut(this.vertexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexBuffer=null}};var Ut=class extends Oe{constructor(t={}){super(t);let{indexSize:r=4,entryIndexSize:o=6,indexLayout:n=null}=t;this.indexed=!0,this.indexSize=r,this.entryIndexSize=o,this.entryElementSize=this.vertexElementSize*this.elementsPerEntry;let s=[];if(n){this.indexLayout=n;for(let a=0;a<this.batchSize*r;a+=r)for(let f=0;f<n.length;f++)s.push(a+n[f])}this.create(),this.createIndexBuffer(s)}createIndexBuffer(t){this.index=new Uint16Array(t),this.indexBuffer=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.index,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null),t=[]}bind(){i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer)}destroy(){super.destroy(),ut(this.indexBuffer),this.index=null,this.indexLayout=null,this.indexBuffer=null}};var uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zo=new Uint8Array(256);for(let e=0;e<uo.length;e++)Zo[uo.charCodeAt(e)]=e;function j(){}var l=class{constructor(t){let r=new Float32Array(16);this.data=r,this.onChange=j,t?Array.isArray(t)?this.fromArray(t):this.fromArray(t.data):(r[0]=1,r[5]=1,r[10]=1,r[15]=1)}set(t,r,o,n,s,a,f,u,h,d,x,g,y,G,tt,se){let C=this.data;return C[0]=t,C[1]=r,C[2]=o,C[3]=n,C[4]=s,C[5]=a,C[6]=f,C[7]=u,C[8]=h,C[9]=d,C[10]=x,C[11]=g,C[12]=y,C[13]=G,C[14]=tt,C[15]=se,this.onChange(this),this}toArray(t=[],r=0){let o=this.data;for(let n=0;n<16;n++)t[r+n]=o[n];return t}fromArray(t,r=0){let o=this.data;for(let n=0;n<16;n++)o[n]=t[r+n];return this.onChange(this),this}toString(){return"[ mat4="+this.data.join(", ")+" ]"}destroy(){this.onChange=j,this.data=null}};function Le(e,t,r,o,n,s,a=new l){let f=1/(e-t),u=1/(r-o),h=1/(n-s);return a.set(-2*f,0,0,0,0,-2*u,0,0,0,0,2*h,0,(e+t)*f,(o+r)*u,(s+n)*h,1)}function ve(e,t){let r=new Map,o={size:1,type:i.FLOAT,normalized:!1,stride:0,offset:0},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){let a=i.getActiveAttrib(e,s);if(!a)break;let f=a.name,u=i.getAttribLocation(e,f);i.enableVertexAttribArray(u);let h=t.hasOwnProperty(f)?t[f]:{},{size:d=o.size,type:x=o.type,normalized:g=o.normalized,stride:y=o.stride,offset:G=o.offset}=h;r.set(f,{index:u,size:d,type:x,normalized:g,stride:y,offset:G})}return r}function mt(...e){e.forEach(t=>{i.deleteShader(t)})}function Ne(...e){let t=i.createProgram();if(e.forEach(o=>{i.attachShader(t,o)}),i.linkProgram(t),!i.getProgramParameter(t,i.LINK_STATUS)){let o=i.getProgramInfoLog(t);return console.error(`Error linking program: ${o}`),i.deleteProgram(t),mt(...e),null}return t}function zt(e,t){let r=i.createShader(t);if(i.shaderSource(r,e),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){let n=i.getShaderInfoLog(r),s=e.split(`
`).map((a,f)=>`${f}: ${a}`);return console.error(`Error compiling shader: ${n}`,s.join(`
`)),i.deleteShader(r),null}return r}function Ue(e,t,r=!1){switch(e.type){case i.INT:case i.BOOL:return r?o=>{i.uniform1iv(t,o)}:o=>{i.uniform1i(t,o)};case i.INT_VEC2:case i.BOOL_VEC2:return o=>{i.uniform2iv(t,o)};case i.INT_VEC3:case i.BOOL_VEC3:return o=>{i.uniform3iv(t,o)};case i.INT_VEC4:case i.BOOL_VEC4:return o=>{i.uniform4iv(t,o)};case i.FLOAT:return r?o=>{i.uniform1fv(t,o)}:o=>{i.uniform1f(t,o)};case i.FLOAT_VEC2:return o=>{i.uniform2fv(t,o)};case i.FLOAT_VEC3:return o=>{i.uniform3fv(t,o)};case i.FLOAT_VEC4:return o=>{i.uniform4fv(t,o)};case i.FLOAT_MAT2:return o=>{i.uniformMatrix2fv(t,!1,o)};case i.FLOAT_MAT3:return o=>{i.uniformMatrix3fv(t,!1,o)};case i.FLOAT_MAT4:return o=>{i.uniformMatrix4fv(t,!1,o)};case i.SAMPLER_2D:case i.SAMPLER_CUBE:return e.size>1?o=>{i.uniform1iv(t,o)}:o=>{i.uniform1i(t,o)}}}function ze(e){let t=new Map,r=i.getProgramParameter(e,i.ACTIVE_UNIFORMS);for(let o=0;o<r;o++){let n=i.getActiveUniform(e,o),s=n.name;if(s.startsWith("gl_")||s.startsWith("webgl_"))continue;let a=i.getUniformLocation(e,n.name);if(a){let f=!1;s.substr(-3)==="[0]"&&(s=s.substr(0,s.length-3),f=n.size>1),t.set(s,Ue(n,a,f))}}return t}var mo=5121;var Vt=5126;var $={aVertexPosition:{size:2,type:Vt,normalized:!1,offset:0},aTextureCoord:{size:2,type:Vt,normalized:!1,offset:8},aTextureId:{size:1,type:Vt,normalized:!1,offset:16},aTintColor:{size:4,type:mo,normalized:!0,offset:20}};var Ve={uProjectionMatrix:new Float32Array,uCameraMatrix:new Float32Array,uTexture:0};function co(e,t,r){i.bindFramebuffer(i.FRAMEBUFFER,e);let o=i.createRenderbuffer();return i.bindRenderbuffer(i.RENDERBUFFER,o),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,o),i.bindFramebuffer(i.FRAMEBUFFER,null),o}function Pe(e,t){t||(t=i.COLOR_ATTACHMENT0);let r=i.createFramebuffer();return i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,t,i.TEXTURE_2D,e,0),i.bindFramebuffer(i.FRAMEBUFFER,null),r}var ho=`#define SHADER_NAME SINGLE_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`;var lo=`#define SHADER_NAME SINGLE_QUAD_VERT

precision highp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute float aTextureId;
attribute vec4 aTintColor;

uniform mat4 uProjectionMatrix;
uniform mat4 uCameraMatrix;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

void main (void)
{
    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vTintColor = aTintColor;

    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);
}`;var Pt=class{constructor(t){this.renderToFramebuffer=!1,this.renderToDepthbuffer=!1,t&&this.fromConfig(t)}fromConfig(t){let{attributes:r=$,fragmentShader:o=ho,height:n=O(),renderToFramebuffer:s=!1,renderToDepthbuffer:a=!1,resolution:f=_(),vertexShader:u=lo,width:h=L(),uniforms:d=Ve}=t;if(this.create(o,u,d,r),s){this.renderToFramebuffer=!0;let x=new M(null,h*f,n*f),g=new q(x);x.binding=g,g.framebuffer=Pe(g.texture),a&&(this.renderToDepthbuffer=!0,g.depthbuffer=co(g.framebuffer,x.width,x.height)),this.texture=x,this.framebuffer=g.framebuffer}}create(t,r,o,n){let s=zt(t,i.FRAGMENT_SHADER),a=zt(r,i.VERTEX_SHADER);if(!s||!a)return;let f=Ne(s,a);if(!f)return;let u=i.getParameter(i.CURRENT_PROGRAM);i.useProgram(f),this.program=f,this.uniformSetters=ze(f),this.uniforms=new Map;for(let[h,d]of Object.entries(o))this.uniforms.set(h,d);this.attributes=ve(f,n),i.useProgram(u)}updateUniforms(t){}bind(t){return this.updateUniforms(t),this.setUniforms(t)}setUniform(t,r){let o=this.uniforms;o.has(t)&&(o.set(t,r),this.uniformSetters.get(t)(r))}setUniforms(t){if(!this.program)return!1;i.useProgram(this.program);let r=this.uniforms;for(let[o,n]of this.uniformSetters.entries())n(r.get(o));return!0}setAttributes(t){if(this.program){let r=t.currentVertexBuffer.vertexByteSize;this.attributes.forEach(o=>{i.vertexAttribPointer(o.index,o.size,o.type,o.normalized,r,o.offset)})}}destroy(){mt(this.program),at(this.texture),st(this.framebuffer),this.uniforms.clear(),this.uniformSetters.clear(),this.attributes.clear(),this.program=null,this.texture=null,this.framebuffer=null}};var U=class extends Pt{constructor(t={}){let r=t;r.attributes=r.attributes?r.attributes:$,super(r)}bind(t){let r=this.uniforms;return r.set("uProjectionMatrix",t.projectionMatrix.data),r.set("uCameraMatrix",t.cameraMatrix.data),super.bind(t)}};var po=`#define SHADER_NAME MULTI_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture[%count%];

void main (void)
{
    vec4 color;

    %forloop%

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`;var kt=class extends U{constructor(t={}){t.fragmentShader||(t.fragmentShader=po),super(t)}create(t,r,o,n){let s=ft(),a="";for(let f=1;f<s;f++)f>1&&(a+=`
	else `),f<s-1&&(a+=`if (vTextureId < ${f}.5)`),a+=`
	{`,a+=`
		color = texture2D(uTexture[${f}], vTextureCoord);`,a+=`
	}`;t=t.replace(/%count%/gi,`${s}`),t=t.replace(/%forloop%/gi,a),super.create(t,r,o,n)}bind(t){return this.uniforms.set("uTexture",t.textureIndex),super.bind(t)}};function ke(e,t,r,o){let n={enable:t,sfactor:r,dfactor:o};e.blendModeStack[0]=n,e.currentBlendMode=n,e.defaultBlendMode=n}function We(e,t=null,r){let o={framebuffer:t,viewport:r};e.framebufferStack[0]=o,e.currentFramebuffer=o,e.defaultFramebuffer=o}function Ye(e,t,r){let o={shader:t,textureID:r};e.shaderStack[0]=o,e.currentShader=o,e.defaultShader=o}function Xe(e,t){e.vertexBufferStack[0]=t,e.currentVertexBuffer=t,e.defaultVertexBuffer=t}function Qe(e,t=0,r=0,o=0,n=0){let s=new E(t,r,o,n);e.viewportStack[0]=s,e.currentViewport=s,e.defaultViewport=s}function ct(e=new l){return e.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}var z=class{constructor(t=1,r=0,o=0,n=1,s=0,a=0){this.set(t,r,o,n,s,a)}set(t=1,r=0,o=0,n=1,s=0,a=0){return this.a=t,this.b=r,this.c=o,this.d=n,this.tx=s,this.ty=a,this}identity(){return this.set()}toArray(){let{a:t,b:r,c:o,d:n,tx:s,ty:a}=this;return[t,r,o,n,s,a]}fromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5])}};var He={PI2:Math.PI*2,HALF_PI:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};var Z=class{constructor(){this.type="StaticCamera",this.dirtyRender=!0;let t=R.get();this.renderer=t.renderer,this.matrix=ct(),this.bounds=new E,this.worldTransform=new z,this.reset()}reset(){let t=this.renderer;if(t){let r=t.width,o=t.height;this.width=r,this.height=o}this.bounds.set(0,0,this.width,this.height)}destroy(){this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null}};var Wt=class{constructor(t){this.count=0,this.prevCount=0,this.flushTotal=0,this.maxTextures=0,this.currentActiveTexture=0,this.startActiveTexture=0,this.tempTextures=[],this.textureIndex=[],this.framebufferStack=[],this.currentFramebuffer=null,this.defaultFramebuffer=null,this.vertexBufferStack=[],this.currentVertexBuffer=null,this.defaultVertexBuffer=null,this.shaderStack=[],this.currentShader=null,this.defaultShader=null,this.viewportStack=[],this.currentViewport=null,this.defaultViewport=null,this.blendModeStack=[],this.currentBlendMode=null,this.defaultBlendMode=null,this.renderer=t,this.projectionMatrix=new l,this.reset()}reset(){let t=this.renderer.gl,r=[0,1,2,2,3,0];this.quadShader=new U,this.quadBuffer=new Ut({isDynamic:!1,indexLayout:r}),this.quadCamera=new Z,Ie(this),We(this),ke(this,!0,t.ONE,t.ONE_MINUS_SRC_ALPHA),Xe(this,new Ut({batchSize:ao(),indexLayout:r})),Ye(this,new kt)}resize(t,r){Le(0,t,r,0,-1e3,1e3,this.projectionMatrix),this.quadCamera.reset(),Qe(this,0,0,t,r)}};function ht(e,t){t||(t=e.currentShader),t.shader.bind(e,t.textureID)&&t.shader.setAttributes(e)}function qe(e,t){e.current2DCamera=t,e.cameraMatrix=t.matrix,ht(e)}function lt(e,t){t||(t=e.currentBlendMode),t.enable?(i.enable(i.BLEND),i.blendFunc(t.sfactor,t.dfactor)):i.disable(i.BLEND)}function pt(e,t){t||(t=e.currentVertexBuffer);let r=t.indexed?t.indexBuffer:null;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),i.bindBuffer(i.ARRAY_BUFFER,t.vertexBuffer)}function Yt(e,t=0){let r=e.currentVertexBuffer;e.count+t>=r.batchSize&&b(e);let o=r.indexed?e.count*r.entryElementSize:e.count*r.vertexElementSize;return e.count+=t,{buffer:r,F32:r.vertexViewF32,U32:r.vertexViewU32,offset:o}}function je(e,t){let r=t.binding,o=e.currentActiveTexture;return r.indexCounter<e.startActiveTexture&&(r.indexCounter=e.startActiveTexture,o<e.maxTextures?(r.setIndex(o),i.activeTexture(i.TEXTURE0+o),i.bindTexture(i.TEXTURE_2D,r.texture),e.currentActiveTexture++):(b(e),e.startActiveTexture++,r.indexCounter=e.startActiveTexture,r.setIndex(1),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,r.texture),e.currentActiveTexture=2)),r.index}function $e(e){e.current2DCamera=e.quadCamera,e.cameraMatrix=e.quadCamera.matrix,e.count=0,e.flushTotal=0,N(e,!1,e.defaultFramebuffer),lt(e,e.defaultBlendMode),v(e,e.defaultViewport),pt(e,e.defaultVertexBuffer)}var go,Ze={get:()=>go,set:e=>{go=e}};var Ke=class{constructor(){this.clearColor=[0,0,0,1],this.clearBeforeRender=!0,this.optimizeRedraw=!1,this.autoResize=!0,this.contextLost=!1,this.width=L(),this.height=O(),this.resolution=_(),this.setBackgroundColor(Me());let t=document.createElement("canvas");t.addEventListener("webglcontextlost",r=>this.onContextLost(r),!1),t.addEventListener("webglcontextrestored",()=>this.onContextRestored(),!1),this.canvas=t,this.initContext(),Ze.set(this),this.renderPass=new Wt(this),this.resize(this.width,this.height,this.resolution)}initContext(){let t=this.canvas.getContext("webgl",ge());ro.set(t),this.gl=t,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)}resize(t,r,o=1){let n=t*o,s=r*o;this.width=n,this.height=s,this.resolution=o;let a=this.canvas;a.width=n,a.height=s,this.autoResize&&(a.style.width=t.toString()+"px",a.style.height=r.toString()+"px"),this.renderPass.resize(n,s)}onContextLost(t){t.preventDefault(),this.contextLost=!0}onContextRestored(){this.contextLost=!1,this.initContext()}setBackgroundColor(t){return oo(t,this.clearColor),this}reset(){}render(t){if(this.contextLost)return;let r=this.gl,o=this.renderPass;if(Be(),this.optimizeRedraw&&t.numDirtyFrames===0&&t.numDirtyCameras===0)return;if(this.clearBeforeRender){let s=this.clearColor;r.clearColor(s[0],s[1],s[2],s[3]),r.clear(r.COLOR_BUFFER_BIT)}let n=t.worldData;$e(o);for(let s=0;s<n.length;s++){let{world:a}=n[s];a.renderGL(o),a.postRenderGL(o)}De(o)}destroy(){Ze.set(void 0)}};function Je(){return()=>{Dt(Ke)}}function tr(e,t=1.70158){return e*e*((t+1)*e-t)}function er(e,t=1.70158){let r=t*1.525;return(e*=2)<1?.5*(e*e*((r+1)*e-r)):.5*((e-=2)*e*((r+1)*e+r)+2)}function Xt(e,t=1.70158){return--e*e*((t+1)*e+t)+1}var qt={};Vo(qt,{In:()=>Qt,InOut:()=>Ht,Out:()=>dt});function Qt(e){return e=1-e,e<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}function Ht(e){let t=!1;return e<.5?(e=1-e*2,t=!0):e=e*2-1,e<1/2.75?e=7.5625*e*e:e<2/2.75?e=7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?e=7.5625*(e-=2.25/2.75)*e+.9375:e=7.5625*(e-=2.625/2.75)*e+.984375,t?(1-e)*.5:e*.5+.5}function dt(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function rr(e){return 1-Math.sqrt(1-e*e)}function or(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}function jt(e){return Math.sqrt(1- --e*e)}function ir(e){return e*e*e}function nr(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}function xt(e){return--e*e*e+1}function sr(e,t=.1,r=.1){if(e===0)return 0;if(e===1)return 1;{let o=r/4;return t<1?t=1:o=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(e-=1))*Math.sin((e-o)*(2*Math.PI)/r))}}function ar(e,t=.1,r=.1){if(e===0)return 0;if(e===1)return 1;{let o=r/4;return t<1?t=1:o=r*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?-.5*(t*Math.pow(2,10*(e-=1))*Math.sin((e-o)*(2*Math.PI)/r)):t*Math.pow(2,-10*(e-=1))*Math.sin((e-o)*(2*Math.PI)/r)*.5+1}}function $t(e,t=.1,r=.1){if(e===0)return 0;if(e===1)return 1;{let o=r/4;return t<1?t=1:o=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-o)*(2*Math.PI)/r)+1}}function fr(e){return Math.pow(2,10*(e-1))-.001}function ur(e){return e==0?0:e==1?1:(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))}function Zt(e){return 1-Math.pow(2,-10*e)}function mr(e){return e*e}function cr(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function St(e){return e*(2-e)}function hr(e){return e*e*e*e}function lr(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function gt(e){return-(--e*e*e*e-1)}function pr(e){return e*e*e*e*e}function dr(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}function Tt(e){return(e=e-1)*e*e*e*e+1}function xr(e){return e===0?0:e===1?1:1-Math.cos(e*Math.PI/2)}function Sr(e){return e===0?0:e===1?1:.5*(1-Math.cos(Math.PI*e))}function Kt(e){return e===0?0:e===1?1:Math.sin(e*Math.PI/2)}function Ct(e){return e}function To(e,t=1){return e<=0?0:e>=1?1:((t*e|0)+1)*(1/t)}var WT=new Map([["power0",Ct],["power1",St],["power2",xt],["power3",gt],["power4",Tt],["linear",Ct],["quad",St],["cubic",xt],["quart",gt],["quint",Tt],["sine",Kt],["expo",Zt],["circ",jt],["elastic",$t],["back",Xt],["bounce",dt],["stepped",To],["quad.in",mr],["cubic.in",ir],["quart.in",hr],["quint.in",pr],["sine.in",xr],["expo.in",fr],["circ.in",rr],["elastic.in",sr],["back.in",tr],["bounce.in",Qt],["quad.out",St],["cubic.out",xt],["quart.out",gt],["quint.out",Tt],["sine.out",Kt],["expo.out",Zt],["circ.out",jt],["elastic.out",$t],["back.out",Xt],["bounce.out",dt],["quad.inout",cr],["cubic.inout",nr],["quart.inout",lr],["quint.inout",dr],["sine.inout",Sr],["expo.inout",ur],["circ.inout",or],["elastic.inout",ar],["back.inout",er],["bounce.inout",Ht]]);var gr=class extends W{constructor(){super();this.baseURL="",this.path="",this.crossOrigin="anonymous",this.maxParallelDownloads=-1,this.isLoading=!1,this.reset()}reset(){this.isLoading=!1,this.queue=new Set,this.inflight=new Set,this.completed=new Set,this.progress=0}add(...t){return t.forEach(r=>{r.loader=this,this.queue.add(r)}),this}start(){return this.isLoading?null:new Promise((t,r)=>{this.completed.clear(),this.progress=0,this.queue.size>0?(this.isLoading=!0,this.onComplete=t,this.onError=r,S(this,"start"),this.nextFile()):(this.progress=1,S(this,"complete"),t(this))})}nextFile(){let t=this.queue.size;if(this.maxParallelDownloads!==-1&&(t=Math.min(t,this.maxParallelDownloads)-this.inflight.size),t){let r=this.queue.values();for(;t>0;){let o=r.next().value;this.inflight.add(o),this.queue.delete(o),o.load().then(n=>this.fileComplete(n)).catch(n=>this.fileError(n)),t--}}else this.inflight.size===0&&this.stop()}stop(){!this.isLoading||(this.isLoading=!1,S(this,"complete",this.completed),this.onComplete(),this.completed.clear())}updateProgress(t){this.inflight.delete(t),this.completed.add(t);let r=this.completed.size,o=this.queue.size+this.inflight.size;r>0&&(this.progress=r/(r+o)),S(this,"progress",this.progress,r,o),this.nextFile()}fileComplete(t){S(this,"filecomplete",t),this.updateProgress(t)}fileError(t){S(this,"fileerror",t),this.updateProgress(t)}totalFilesToLoad(){return this.queue.size+this.inflight.size}setBaseURL(t=""){return t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.baseURL=t,this}setPath(t=""){return t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.path=t,this}setCORS(t){return this.crossOrigin=t,this}setMaxParallelDownloads(t){return this.maxParallelDownloads=t,this}};function V(e){let t=[e],r=[];for(;t.length>0;){let o=t.shift();r.push(o);let n=o.numChildren;if(n>0)for(let s=n-1;s>=0;s--)t.unshift(o.children[s])}return r.shift(),r}function F(e,t){return e.children.indexOf(t)}function Jt(e,t){let r=e.children,o;if(t>=0&&t<r.length){let n=r.splice(t,1);n[0]&&(o=n[0],o.parent=null)}return o}function Rt(e,t){let r=F(e,t);return r>-1&&Jt(e,r),t}var te="addedtoworld";var yt="destroy";var Tr="postupdate";var ee="removedfromworld";var K="update";function Cr(e,...t){return t.forEach(r=>{r.world&&(S(r.world,ee,r,r.world),S(r,ee,r,r.world)),r.world=e,S(e,te,r,e),S(r,te,r,e)}),t}function P(e,...t){t.forEach(o=>{o.parent&&Rt(o.parent,o),o.parent=e});let r=e.world;return r&&Cr(r,...V(e)),t}function Rr(e,t){return e.children.push(t),P(e,t),t.updateWorldTransform(),t}function yr(e,...t){return t.forEach(r=>{Rr(e,r)}),t}var p={CLEAR:0,TRANSFORM:1,UPDATE:2,CHILD_CACHE:4,POST_RENDER:8,COLORS:16,BOUNDS:32,TEXTURE:64,FRAME:128,ALPHA:256,CHILD:512,DEFAULT:1+2+16+32,USER1:536870912,USER2:1073741824,USER3:2147483648,USER4:4294967296};function Mt(e,t=0,r){let o=e.children;r===void 0&&(r=o.length);let n=r-t;if(n>0&&n<=r){let s=o.splice(t,n);return s.forEach(a=>{a.parent=null}),s}else return[]}function Mr(e,t=0,r){Mt(e,t,r).forEach(n=>{n.destroy()})}function Er(e,...t){return t.forEach(r=>{Rt(e,r)}),t}function br(e,t,r=0,o){let n=Mt(e,r,o);return P(t,...n),n.forEach(s=>{s.updateWorldTransform()}),n}var Ar=class{constructor(t,r){this.name=t,typeof r=="string"?(this.modifier=r.substr(0,1),this.end=parseFloat(r.substring(1))):this.end=r}getEnd(t){let r=this.modifier,o=this.end;return r==="+"?t+o:r==="-"?t-o:o}to(t){let r=t[this.name],o=this.getEnd(r);this.start=r,this.end=o}from(t){let r=t[this.name],o=this.getEnd(r);this.start=o,this.end=r,t[this.name]=o}update(t,r){t[this.name]=this.start+(this.end-this.start)*r}};var wr=class{constructor(t,r,o=!0){this.state={running:!1,repeat:!1,hold:!1,delay:!1,yoyo:!1,yoyoing:!1,autoStart:!0,reversed:!1},this.init={duration:0,repeat:0,repeatDelay:0,hold:0,delay:0},this.counters={repeat:0,delay:0,progress:0,elapsed:0},this.ease=Ct,this.properties=[],r||(r=R.get()),this.target=t,this.state.autoStart=o,this.emitter=r}to(t,r=null){return this.add(t,r,!1)}from(t,r=null){return this.add(t,r,!0)}add(t,r,o){let n=this.state,s=this.init;if(n.running)return this;let a=this.properties;for(let[f,u]of Object.entries(r))a.push(new Ar(f,u));return s.duration=t,n.reversed=o,n.autoStart&&this.start(),this}start(){let t=this.state;if(t.running)return this;let r=this.target;return this.properties.forEach(n=>{t.reversed?n.from(r):n.to(r)}),t.running=!0,this.listener=w(this.emitter,K,n=>this.update(n)),this}restart(){let t=this.state,r=this.init,o=this.counters;if(!t)throw"Cannot restart destroyed tween";return o.delay=r.delay,o.elapsed=0,o.progress=0,o.repeat=r.repeat,t.yoyoing=!1,t.running=!0,this}update(t){let r=this.state,o=this.init,n=this.counters;if(!r.running)return!1;if(n.delay>0)if(n.delay-=t,n.delay<=0)n.elapsed=Math.abs(n.delay)-t,n.delay=0;else return!1;n.elapsed+=t;let s=Math.min(n.elapsed/o.duration,1);n.progress=s;let a=r.yoyoing?this.ease(1-s):this.ease(s),f=this.target;if(this.properties.forEach(d=>{d.update(f,a)}),s<1)return!1;let h=n.elapsed-o.duration;return r.yoyo&&!r.yoyoing?(n.elapsed=h,n.delay=o.hold-h,r.yoyoing=!0,!1):n.repeat>0?(n.repeat--,n.elapsed=h,n.delay=o.repeatDelay-h,r.yoyoing=!1,!1):(this.destroy(),!0)}delay(t){let r=t;return this.init.delay=r,this.counters.delay=r,this}hold(t){return this.init.hold=t,this}yoyo(t=!0){return this.state.yoyo=t,this}repeat(t=1,r=0){let o=this.init;return this.state.repeat=t>0,this.counters.repeat=t,o.repeat=t,o.repeatDelay=r,this}easing(t){return this.ease=t,this}destroy(){I(this.emitter,K,this.listener),this.properties.length=0,this.target=null,this.ease=null,this.emitter=null,this.state=null,this.init=null,this.counters=null}};function Co(e,t=null,r=!0){return new wr(e,t,r)}var Fr=class{constructor(t,r,o){this.responseType="text",this.crossOrigin=void 0,this.skipCache=!1,this.hasLoaded=!1,this.key=t,this.url=r,this.config=o}};function Ro(e,t,r,o){return t||(t=e+r),/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/.exec(t)?t:o?o.baseURL+o.path+t:t}function yo(e){return e.data=new Image,e.crossOrigin&&(e.data.crossOrigin=e.crossOrigin),new Promise((t,r)=>{e.data.onload=()=>{e.data.onload&&(e.data.onload=null,e.data.onerror=null,t(e))},e.data.onerror=o=>{e.data.onload&&(e.data.onload=null,e.data.onerror=null,e.error=o,r(e))},e.data.src=e.url,e.data.complete&&e.data.width&&e.data.height&&(e.data.onload=null,e.data.onerror=null,t(e))})}function Mo(e,t,r){let o=new Fr(e,t);return o.load=()=>(o.url=Ro(o.key,o.url,".png",o.loader),o.loader&&(o.crossOrigin=o.loader.crossOrigin),new Promise((n,s)=>{let a=D.get();a.has(o.key)?n(o):yo(o).then(f=>{a.add(f.key,f.data,r),n(f)}).catch(f=>{s(f)})})),o}function Eo(e,t,r){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:r}function bo(e,t={}){let r=Gt.get(),o=r.scenes.size,n=r.sceneIndex,s=o===0;typeof t=="string"?e.key=t:(t||!t&&s)&&(e.key=Eo(t,"key","scene"+n.toString())),r.scenes.has(e.key)?console.warn("Scene key already in use: "+e.key):(r.scenes.set(e.key,e),r.flush=!0,r.sceneIndex++)}var Dr=class{constructor(t){this.game=R.get(),this.events=new Map,bo(this,t)}};function Et(e,t){let{a:r,b:o,c:n,d:s,tx:a,ty:f}=e,{x:u,y:h,right:d,bottom:x}=t,g=u*r+h*n+a,y=u*o+h*s+f,G=u*r+x*n+a,tt=u*o+x*s+f,se=d*r+x*n+a,C=d*o+x*s+f,No=d*r+h*n+a,Uo=d*o+h*s+f;return{x0:g,y0:y,x1:G,y1:tt,x2:se,y2:C,x3:No,y3:Uo}}var re=class{constructor(t){this.fixed=!1,this.includeChildren=!0,this.visibleOnly=!0,this.entity=t,this.area=new E}set(t,r,o,n){this.area.set(t,r,o,n)}get(){return this.entity.isDirty(p.BOUNDS)&&!this.fixed&&this.update(),this.area}updateLocal(){let{x0:t,y0:r,x1:o,y1:n,x2:s,y2:a,x3:f,y3:u}=Et(this.entity.worldTransform,this.entity.transformExtent),h=Math.min(t,o,s,f),d=Math.min(r,n,a,u),x=Math.max(t,o,s,f),g=Math.max(r,n,a,u);return this.area.set(h,d,x-h,g-d)}update(){let t=this.updateLocal();if(this.entity.clearDirty(p.BOUNDS),!this.includeChildren||!this.entity.numChildren)return t;let r=this.visibleOnly,o=this.entity.children,n=t.x,s=t.y,a=t.right,f=t.bottom;for(let u=0;u<o.length;u++){let h=o[u];if(!h||r&&!h.visible)continue;let d=h.bounds.get();d.x<n&&(n=d.x),d.y<s&&(s=d.y),d.right>a&&(a=d.right),d.bottom>f&&(f=d.bottom)}return t.set(n,s,a-n,f-s)}destroy(){this.entity=null,this.area=null}};var oe=class{constructor(t){this.enabled=!1,this.enabledChildren=!0,this.entity=t}destroy(){this.entity=null,this.hitArea=null}};var A=class{constructor(t=0,r=0){this.set(t,r)}set(t=0,r=0){return this.x=t,this.y=r,this}toArray(t=[],r=0){let{x:o,y:n}=this;return t[r]=o,t[r+1]=n,t}fromArray(t,r=0){return this.set(t[r],t[r+1])}toString(){let{x:t,y:r}=this;return`{ x=${t}, y=${r} }`}};function Ao(e){e.forEach(t=>{t.packColor()})}function Br(e){let t=e.vertices,{x0:r,y0:o,x1:n,y1:s,x2:a,y2:f,x3:u,y3:h}=Et(e.worldTransform,e.transformExtent);return t[0].setPosition(r,o),t[1].setPosition(n,s),t[2].setPosition(a,f),t[3].setPosition(u,h),e}function bt(e){return e.isDirty(p.COLORS)&&(Ao(e.vertices),e.clearDirty(p.COLORS)),e.isDirty(p.TRANSFORM)&&(Br(e),e.clearDirty(p.TRANSFORM)),e}function Gr(e,t){let[r,o,n,s,a,f,u]=t;e.set(Math.cos(n+u)*s,Math.sin(n+u)*s,-Math.sin(n-f)*a,Math.cos(n-f)*a,r,o)}function Ir(e,t){let{a:r,b:o,c:n,d:s,tx:a,ty:f}=e;return t.set(r,o,n,s,a,f)}function Or(e,t,r,o){if(!o)Ir(e,t);else if(r)Ir(o,t);else{let{a:n,b:s,c:a,d:f,tx:u,ty:h}=e,{a:d,b:x,c:g,d:y,tx:G,ty:tt}=o;t.set(n*d+s*g,n*x+s*y,a*d+f*g,a*x+f*y,u*d+h*g+G,u*x+h*y+tt)}}function _r(e,t){return(((t*255|0)&255)<<24|e)>>>0}var B=class{constructor(t=0,r=0,o=0){this.x=0,this.y=0,this.z=0,this.u=0,this.v=0,this.texture=0,this.tint=16777215,this.alpha=1,this.color=4294967295,this.x=t,this.y=r,this.z=o}setPosition(t,r,o=0){return this.x=t,this.y=r,this.z=o,this}setUV(t,r){return this.u=t,this.v=r,this}setColor(t,r=1){return this.tint=t,this.alpha=r,this.packColor(),this}setAlpha(t){return this.alpha=t,this}setTint(t){return this.tint=t,this}packColor(){this.color=_r(this.tint,this.alpha)}};function Lr(e,t,r){let{F32:o,U32:n,offset:s}=Yt(r,1),a=je(r,e),f=s;t.forEach(u=>{o[f+0]=u.x,o[f+1]=u.y,o[f+2]=u.u,o[f+3]=u.v,o[f+4]=a,n[f+5]=u.color,f+=6})}function vr(){return c.get(m.DEFAULT_ORIGIN).x}function Nr(){return c.get(m.DEFAULT_ORIGIN).y}function wo(e,t=new A){return t.set(e.width,e.height)}var T={X:0,Y:1,ROTATION:2,SCALE_X:3,SCALE_Y:4,SKEW_X:5,SKEW_Y:6,ORIGIN_X:7,ORIGIN_Y:8,PASSTHRU:9};var k=class{constructor(t=0,r=0){this.type="GameObject",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.vertices=[],this.events=new Map,this.localTransform=new z,this.worldTransform=new z,this.transformData=new Float32Array([t,r,0,1,1,0,0,vr(),Nr(),0]),this.transformExtent=new E,this.bounds=new re(this),this.input=new oe(this),this.dirty=p.DEFAULT,this.updateLocalTransform(),this.updateWorldTransform()}isRenderable(){return this.visible&&this.willRender}isDirty(t){return(this.dirty&t)!=0}clearDirty(t){return this.isDirty(t)&&(this.dirty^=t),this}setDirty(t,r){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=R.getFrame()),this.isDirty(r)||(this.dirty^=r),this}update(t,r){if(this.willUpdateChildren){let o=this.children;for(let n=0;n<o.length;n++){let s=o[n];s&&s.willUpdate&&s.update(t,r)}}this.postUpdate(t,r)}postUpdate(t,r){}renderGL(t){}renderCanvas(t){}postRenderGL(t){}postRenderCanvas(t){}get numChildren(){return this.children.length}getBounds(){return this.bounds.get()}updateTransform(t,r){this.transformData[t]!==r&&(this.transformData[t]=r,this.updateLocalTransform(),this.updateWorldTransform())}updateLocalTransform(){this.setDirty(p.TRANSFORM,p.BOUNDS),Gr(this.localTransform,this.transformData)}updateWorldTransform(){this.setDirty(p.TRANSFORM,p.BOUNDS);let t=this.parent?this.parent.worldTransform:void 0;if(Or(this.localTransform,this.worldTransform,this.passthru,t),this.numChildren){let r=this.children;for(let o=0;o<r.length;o++)r[o].updateWorldTransform()}}setExtent(t,r,o,n){this.transformExtent.set(t,r,o,n),this.setDirty(p.TRANSFORM,p.BOUNDS)}updateExtent(t,r){let o=this.transformExtent;t!==void 0&&(o.width=t),r!==void 0&&(o.height=r),o.x=-this.originX*o.width,o.y=-this.originY*o.height,this.setDirty(p.TRANSFORM,p.BOUNDS)}setSize(t,r=t){return this.updateExtent(t,r),this}setPosition(t,r){return this.x=t,this.y=r,this}setSkew(t,r=t){return this.skewX=t,this.skewY=r,this}setScale(t,r=t){return this.scaleX=t,this.scaleY=r,this}setRotation(t){return this.rotation=t,this}setOrigin(t,r=t){let o=this.transformData;return o[T.ORIGIN_X]=t,o[T.ORIGIN_Y]=r,this.updateExtent(),this}getSize(t=new A){return wo(this.transformExtent,t)}getPosition(t=new A){return t.set(this.x,this.y)}getOrigin(t=new A){return t.set(this.originX,this.originY)}getSkew(t=new A){return t.set(this.skewX,this.skewY)}getScale(t=new A){return t.set(this.scaleX,this.scaleY)}getRotation(){return this.rotation}set width(t){this.updateExtent(t)}get width(){return this.transformExtent.width}set height(t){this.updateExtent(void 0,t)}get height(){return this.transformExtent.height}set x(t){this.updateTransform(T.X,t)}get x(){return this.transformData[T.X]}set y(t){this.updateTransform(T.Y,t)}get y(){return this.transformData[T.Y]}set originX(t){let r=this.transformData;t!==r[T.ORIGIN_X]&&(r[T.ORIGIN_X]=t,this.updateExtent())}get originX(){return this.transformData[T.ORIGIN_X]}set originY(t){let r=this.transformData;t!==r[T.ORIGIN_Y]&&(r[T.ORIGIN_Y]=t,this.updateExtent())}get originY(){return this.transformData[T.ORIGIN_Y]}set skewX(t){this.updateTransform(T.SKEW_X,t)}get skewX(){return this.transformData[T.SKEW_X]}set skewY(t){this.updateTransform(T.SKEW_Y,t)}get skewY(){return this.transformData[T.SKEW_Y]}set scaleX(t){this.updateTransform(T.SCALE_X,t)}get scaleX(){return this.transformData[T.SCALE_X]}set scaleY(t){this.updateTransform(T.SCALE_Y,t)}get scaleY(){return this.transformData[T.SCALE_Y]}set rotation(t){this.updateTransform(T.ROTATION,t)}get rotation(){return this.transformData[T.ROTATION]}set passthru(t){this.updateTransform(T.PASSTHRU,Number(t))}get passthru(){return Boolean(this.transformData[T.PASSTHRU])}destroy(t){t?br(this,t):Mr(this),S(this,yt,this),this.bounds.destroy(),this.input.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null,this.vertices=[]}};var At=class extends k{constructor(t=0,r=0){super(t,r);this._alpha=1,this.type="Container"}get alpha(){return this._alpha}set alpha(t){t!==this._alpha&&(this._alpha=t,this.vertices.forEach(r=>{r.setAlpha(t)}),this.setDirty(p.COLORS))}};function Ur(e,t,r,o,n){if(!e)return;let s=n.ctx,{a,b:f,c:u,d:h,tx:d,ty:x}=r,{x:g,y}=o;s.save(),s.setTransform(a,f,u,h,d,x),s.globalAlpha=t,s.drawImage(e.texture.image,e.x,e.y,e.width,e.height,g,y,e.width,e.height),s.restore()}function ie(e,t,...r){let o=e.getFrame(t),n=o.pivot;return r.forEach(s=>{!s||o===s.frame||(s.frame=o,s.hasTexture=!0,n&&s.setOrigin(n.x,n.y),o.copyToExtent(s),o.copyToVertices(s.vertices))}),r}function Fo(e){return D.get().get(e)}function Do(e,t,...r){if(!e)r.forEach(o=>{o.texture=null,o.frame=null,o.hasTexture=!1});else{let o;e instanceof H?(t=e,o=e.texture):e instanceof M?o=e:o=Fo(e),o?(r.forEach(n=>{n.texture=o}),ie(o,t,...r)):console.warn(`Invalid Texture key: ${e}`)}return r}var J=class extends At{constructor(t,r,o,n){super(t,r);this.hasTexture=!1,this._tint=16777215,this.type="Sprite",this.vertices=[new B,new B,new B,new B],this.setTexture(o,n)}setTexture(t,r){return Do(t,r,this),this}setFrame(t){return ie(this.texture,t,this),this}isRenderable(){return this.visible&&this.willRender&&this.hasTexture&&this.alpha>0}renderGL(t){bt(this),Lr(this.texture,this.vertices,t)}renderCanvas(t){bt(this),Ur(this.frame,this.alpha,this.worldTransform,this.transformExtent,t)}get tint(){return this._tint}set tint(t){t!==this._tint&&(this._tint=t,this.vertices.forEach(r=>{r.setTint(t)}),this.setDirty(p.COLORS))}destroy(t){super.destroy(t),this.texture=null,this.frame=null,this.hasTexture=!1}};var zr="worldrender";var Vr="worldshutdown";function Pr(e,t){t.numRendered++,t.numRenderable++,e.node.dirtyFrame>=t.gameFrame&&t.dirtyFrame++,e.children.forEach(r=>{r.children.length>0&&Pr(r,t)})}function Go(e){if(e.node.isDirty(p.CHILD_CACHE))return!0;let t=[e];for(;t.length>0;){let r=t.pop();if(r.node.isDirty(p.TRANSFORM))return!0;let o=r.children.length;if(o>0)for(let n=0;n<o;n++)t.push(r.children[n])}return t.length=0,!1}function Io(e,t){e.forEach(r=>{t||Go(r)?r.node.setDirty(p.CHILD_CACHE):r.children.length=0})}function kr(e,t,r=[]){for(let o=0;o<t.numChildren;o++){let n=t.children[o];if(n.isRenderable()){let s=[],a={node:n,children:s};r.push(a),n.willRenderChildren&&n.numChildren>0&&(n.willCacheChildren&&e.push(a),kr(e,n,s))}}return r}function Oo(e){let t=[],o=kr(t,e,[]),n=e.renderData;t.length>0&&Io(t,e.camera.dirtyRender),o.forEach(s=>{s.children.length>0?Pr(s,n):(n.numRendered++,n.numRenderable++,s.node.dirtyFrame>=n.gameFrame&&n.dirtyFrame++)}),e.renderList=o,e.forceRefresh&&(n.dirtyFrame++,e.forceRefresh=!1)}function _o(e,t){return e.a===t.a&&e.b===t.b&&e.c===t.c&&e.d===t.d&&e.tx===t.tx&&e.ty===t.ty}function Lo(e,t){e.numDirtyFrames+=t.dirtyFrame,e.numTotalFrames+=t.numRendered,t.camera.dirtyRender&&e.numDirtyCameras++,e.worldData.push(t)}function ne(e,t){e.gameFrame=t,e.dirtyFrame=0,e.numRendered=0,e.numRenderable=0}var Wr=class extends k{constructor(t){super();this.forceRefresh=!1,this.is3D=!1,this.type="BaseWorld",this.scene=t,this.world=this,this.events=new Map,this.renderList=[],this._updateListener=w(t,"update",(r,o)=>this.update(r,o)),this._renderListener=w(t,"render",r=>this.render(r)),this._shutdownListener=w(t,"shutdown",()=>this.shutdown()),rt(t,"destroy",()=>this.destroy())}update(t,r){!this.willUpdate||(S(this,K,t,r,this),super.update(t,r))}postUpdate(t,r){S(this,Tr,t,r,this)}render(t){let r=this.renderData;ne(r,t.gameFrame),!(!this.willRender||!this.visible)&&(Oo(this),S(this,zr,r,this),Lo(t,r),this.camera.dirtyRender=!1)}renderGL(t){let r=t.current2DCamera,o=this.camera;(!r||!_o(o.worldTransform,r.worldTransform))&&b(t),qe(t,o),this.renderList.forEach(n=>{n.children.length>0?this.renderNode(n,t):n.node.renderGL(t)})}renderNode(t,r){t.node.renderGL(r),t.children.forEach(o=>{o.children.length>0?this.renderNode(o,r):o.node.renderGL(r)}),t.node.postRenderGL(r)}postRenderGL(t){}shutdown(){let t=this.scene;I(t,"update",this._updateListener),I(t,"render",this._renderListener),I(t,"shutdown",this._shutdownListener),Er(this),S(this,Vr,this),ne(this.renderData,0),this.camera&&this.camera.reset()}destroy(t){super.destroy(t),S(this,yt,this),ne(this.renderData,0),this.camera&&this.camera.destroy(),this.events.clear(),this.camera=null,this.renderData=null,this.events=null}};function vo(e,t){return{world:e,camera:t,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var Yr=class extends Wr{constructor(t){super(t);this.type="StaticWorld",this.camera=new Z,this.renderData=vo(this,this.camera)}};var Xr=class extends Dr{constructor(){super();this.preload()}async preload(){let t=new gr;t.add(Mo("logo","assets/logo.png")),await t.start(),this.create()}create(){let t=new J(400,100,"logo").setRotation(.3),r=new Yr(this);Co(t).to(3e3,{y:400,rotation:0}).easing(qt.Out),yr(r,t)}};var Qr=[Xr];console.log(Qr);new Re(Je(),Ft("game"),Lt(window.innerWidth,window.innerHeight),ye(0),Bt(Qr));})();
/**
 * @author       Niklas von Hertzen (https://github.com/niklasvh/base64-arraybuffer)
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
